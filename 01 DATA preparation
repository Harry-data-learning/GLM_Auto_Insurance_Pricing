-- Connect to the database 
CONNECT TO DATABASE X_INSURANCE
USING 'server=X_server; database=X1; user=Harry.Z; password=88888888';

-- Extract policy data for comprehensive insurance
CREATE TABLE Policy_Data AS
SELECT 
    Policy_ID,
    Customer_ID,
    Vehicle_ID,
    Policy_Start_Date,
    Policy_End_Date,
    Policy_Term,         
    Policy_Status,       
    Renewal_Status,      
    Premium_Amount,
    Deductible_Amount,    
    Coverage_Limit,       
    Coverage_Type,       
    Zipcode,
    Region,
    Exposure,            
    Customer_Age,
    Customer_Gender,
    Marital_Status,
    Credit_Score,
    Years_With_Company,  
    Claim_History,      
    Vehicle_Type,
    Vehicle_Make,
    Vehicle_Model,
    Vehicle_Year,
    Vehicle_Price,
    Vehicle_Usage,       
    Mileage,             
    Anti_Theft_Device,    
    Garaging_Location
FROM Policies
LEFT JOIN Customers 
    ON Policies.Customer_ID = Customers.Customer_ID
LEFT JOIN Vehicles 
    ON Policies.Vehicle_ID = Vehicles.Vehicle_ID
WHERE Coverage_Type = 'Comprehensive';

-- Extract claims data separately
CREATE TABLE Claim_Data AS
SELECT 
    Claim_ID,
    Policy_ID,
    Claim_Date,
    Claim_Amount,
    Claim_Type,
    Claim_Status,
    At_Fault,
    Claim_Cause
FROM Claims;

